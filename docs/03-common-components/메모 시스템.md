---
title: 메모 시스템
created: 2026-02-22
updated: 2026-02-23
tags: [component, status/in-progress]
---

# 메모 시스템

> [!info] 구현 위치
> `js/sense-makers.js` — 메모 CRUD, 하이라이트, 드래그 정렬, 인증 연동
> `css/sense-makers.css` — 포스트잇 스타일 메모 블럭, 하이라이트 색상
> `css/variables.css` — 메모 관련 CSS 변수 (`--color-memo-*`, `--memo-*`)

현재 [[Sense Makers]] 페이지에서 사용. 추후 [[My Note]] 등 다른 페이지 확장 가능.

---

## 메모 블럭 정의

### 형태

#### 크기
1. **default** : 최대 5개의 블럭을 정렬할 수 있는 크기 (사용자 임의 변경 불가)
   - CSS: `max-height: var(--memo-block-height)` = `calc((90vh - 200px) / 5)`
   - 메모 리스트 상하 30px 여백 포함, 최대 5개 블럭 온전히 표시
2. **클릭 시** : 10줄의 텍스트를 볼 수 있는 크기로 늘어남 (사용자 임의 변경 불가)
   - CSS: `max-height: 280px` (`.is-selected`)
3. **클릭 해제** 조건:
   1. 상단으로부터 아래로 20px 범위를 클릭 시 해제 (`.memo-block__deselect-zone`)
      - 해당 부분 마우스 호버 시 옅은 음영으로 영역 구분 (`--color-memo-deselect-hover`)
   2. 다른 메모 블럭 클릭 시 현재 해제 + 새 블럭 선택 활성화
   3. 우측 25% 메모 영역 외 클릭 시 해제
   4. 해제 시 default 크기로 복귀

#### 모양
1. **포스트잇 스타일** — 직관적으로 포스트잇이 연상되는 형태
   - 따뜻한 톤의 배경색 (`--color-memo`)
   - 부유감 있는 그림자 (`box-shadow`)
2. **왼쪽 상단 접힘** — `.memo-block__fold`
   - 14px 크기의 대각선 그라데이션 (상위 배경 50% + 접힘 색상 50%)
   - 접혀있는 부분 드래그로 블럭 순서 변경 가능 (HTML5 Drag and Drop)
3. **입력 영역 비구분** — textarea의 border, background 없음 (투명)
4. **빈메모/발췌 비구분** — 데이터상 `type: 'empty' | 'excerpt'`로 구분하지만, UI에서는 동일 표시
5. **날짜 표기** — 우측 최하단, 매우 작게(10px) 연.월만 표기 (예: `26.02`)

### 생성 방법

#### 생성 조건
| 로그인 상태 | 동작 |
|------------|------|
| 로그인됨 (이메일 인증 완료) | 메모 블럭 정상 생성 |
| 미로그인 또는 미인증 | `login.html`로 이동 (Firebase Auth 연동) |

> [!note] Firebase 인증 연동
> - `window.SensePoint.isLoggedIn()` → `firebase.auth().currentUser` + `emailVerified` 확인
> - 미로그인 시 `login.html`로 리다이렉트
> - 회원가입: `signup.html` (이메일, 비밀번호, 닉네임, 최근 감명받은 이야기, 좋아하는 이야기)
> - 이메일 인증 필수 — 인증 완료 전 메모 기능 사용 불가

#### 방법 1. 텍스트 드래그 → 우클릭 → "Memo"
1. 본문(좌측 75%)에서 텍스트 **드래그** 선택
2. **우클릭** → 커스텀 컨텍스트 메뉴 (`#contextMenu`) 표시
3. **"Memo"** 항목 클릭
4. 우측 사이드바에 **메모 블럭 생성** (선택한 텍스트 인용 포함)
5. 본문의 드래그한 텍스트 부분에 **옅은 노란색 배경** 적용 (영구)
6. 클릭 시 컨텐츠 드래그 내용이 **화면 정중앙**으로 위치하도록 스크롤 자동 이동

#### 방법 2. "+" 버튼 클릭
1. 사이드바 하단의 **"+" 버튼** 클릭
2. 첫번째 메모 생성 전까지 버튼은 설명 텍스트 하단 **30px** 간격에 위치
3. **빈 메모 블럭** 생성
4. 본문 하이라이트 없음

### 수정 및 삭제 방법
1. **수정** — 클릭 시 수정 및 작성 가능 (seamless textarea)
2. **삭제** — 메모 블럭 영역 **우클릭** → "삭제" 컨텍스트 메뉴 (`#memoContextMenu`)
   - 활성/비활성 모든 상태에서 가능

---

## 메모 블럭 정렬 규칙

```
┌─────────────────────┐
│ 메모 #1 (가장 오래됨) │ ← 최상단
├─────────────────────┤
│ 메모 #2              │
├─────────────────────┤
│ 메모 #3 (가장 최근)   │ ← 최하단
├─────────────────────┤
│       [ + ]          │ ← 추가 버튼
└─────────────────────┘
```

- 오래된 블럭 → **최상단**
- 새 블럭 → **최하단** (추가 버튼 바로 위)
- 생성 시간 순 정렬 (사용자 드래그 정렬로 변경 가능)

---

## 첫 메모 생성 시 동작

**생성 전:**
```
┌─────────────────────┐
│ Memo (24pt)          │
│ 설명 텍스트 (14pt)    │
│                     │
│    (30px 간격)       │
│       [ + ]          │
└─────────────────────┘
```

**첫 메모 생성 후:**
```
┌─────────────────────┐
│ 메모 #1              │ ← 헤더 전체 숨김 (display: none)
├─────────────────────┤
│       [ + ]          │
└─────────────────────┘
```

---

## 텍스트 하이라이트

### 색상 정의

| 상태 | 배경색 | CSS 변수 |
|------|--------|---------|
| 기본 (영구) | 옅은 노란색 | `--color-highlight-light` |
| 선택 중 | 진한 노란색 | `--color-highlight-active` |

### 동작 규칙

```
텍스트 드래그 → 메모 생성
    ↓
해당 텍스트에 옅은 노란색 배경 (영구 적용)
    ↓
메모 블럭 클릭/선택
    ↓
연결된 텍스트가 진한 노란색으로 변경 + 화면 중앙 스크롤
    ↓
메모 블럭 선택 해제
    ↓
다시 옅은 노란색으로 복귀
```

> [!important] 핵심
> - 하이라이트는 **영구 적용** — 메모를 만든 순간부터 계속 유지
> - 진한 노란색은 **메모 블럭이 선택된 동안만** 일시적으로 적용
> - 메모 선택 시 본문의 해당 하이라이트가 **화면 정중앙으로 자동 스크롤**

---

## "+" 추가 버튼

| 속성 | 값 |
|------|-----|
| 형태 | 투명색 **라운드 박스** |
| 텍스트 | `+` (중앙 정렬) |
| 기본 상태 | 투명 배경 |
| 호버 | 음영이 짙어짐 |
| 클릭 | 메모 블럭 생성 (로그인 필요) |

### 위치 규칙

| 상태 | 위치 |
|------|------|
| 메모 없음 | 설명 텍스트 하단 30px 간격 |
| 메모 있음 | 마지막 메모 블럭 하단 |

---

## 메모 블럭 구조

```
┌──┬──────────────────┐
│▚ │  (deselect zone) │  ← 접힘 코너(드래그) + 상단 20px 해제 영역
├──┴──────────────────┤
│ "인용된 텍스트..."     │  ← 발췌 텍스트 (있을 경우, 구분 없이 표시)
│ 메모 내용 입력 영역    │  ← seamless textarea
│                      │
│                26.02 │  ← 연.월 (10px, 우측 하단)
└─────────────────────┘
```

---

## 드래그 정렬

- 왼쪽 상단 접혀있는 부분 (`.memo-block__fold`)에서 드래그 시작
- HTML5 Drag and Drop API 사용
- 드래그 중 해당 블럭 투명도 40%
- 드롭 위치에 `--color-accent` 색상 상단 보더 표시
- 드롭 시 `memos` 배열 순서 DOM 순서에 동기화

---

## 반응형

| 디바이스 | 동작 |
|---------|------|
| PC | 우측 사이드바에 항상 표시 |
| 태블릿 | 사이드바 접기/펼치기 토글 |
| 모바일 | 하단 시트 또는 플로팅 버튼 |
