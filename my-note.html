<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Note - SensePoint</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/my-note.css">
  <link rel="stylesheet" href="css/responsive.css">
</head>
<body>

  <!-- Header -->
  <header class="header">
    <a href="index.html" class="header__logo">
      <span class="header__logo-icon">SP</span>
      <span>SensePoint</span>
    </a>
    <button class="header__menu-btn" id="menuToggle" aria-label="메뉴 열기">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </header>

  <!-- Menu Overlay -->
  <div class="menu-backdrop" id="menuBackdrop"></div>
  <nav class="menu-panel" id="menuPanel">
    <div class="menu-panel__header">
      <a href="index.html" class="menu-panel__logo">SensePoint</a>
      <button class="menu-panel__auth" id="authBtn">로그인</button>
    </div>
    <ul class="menu-panel__nav">
      <li><a href="my-note.html" class="menu-panel__nav-item is-active">My Note</a></li>
      <li><a href="sense-makers.html" class="menu-panel__nav-item">Sense Makers</a></li>
      <li><a href="square.html" class="menu-panel__nav-item">Square</a></li>
    </ul>
    <div class="menu-panel__footer">
      <p class="menu-panel__footer-text">© 2026 SensePoint. All rights reserved.</p>
      <p class="menu-panel__footer-text">contact@sensepoint.kr</p>
      <p class="menu-panel__footer-text">02-1234-5678</p>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <div class="my-note">

      <!-- Left 75% - Note Editor -->
      <div class="my-note__editor">

        <!-- Editor Toolbar -->
        <div class="my-note__toolbar">
          <div class="my-note__toolbar-left">
            <button class="my-note__new-btn" id="newNoteBtn" title="새 노트">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              <span>새 노트</span>
            </button>
          </div>
          <div class="my-note__toolbar-center">
            <div class="my-note__type-switch" id="noteTypeSwitch">
              <button class="my-note__type-btn is-active" data-type="blank">무지</button>
              <button class="my-note__type-btn" data-type="template">양식지</button>
              <div class="my-note__type-indicator"></div>
            </div>
          </div>
          <div class="my-note__toolbar-right">
            <button class="my-note__save-btn" id="saveNoteBtn" title="저장">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
              </svg>
              <span>저장</span>
            </button>
          </div>
        </div>

        <!-- Editor Body -->
        <div class="my-note__body" id="noteBody">

          <!-- Preview Panel (메모 클릭 시 출처 컨텐츠 표시) -->
          <div class="my-note__preview" id="notePreview" style="display:none">
            <div class="my-note__preview-header">
              <div class="my-note__preview-meta">
                <span class="my-note__preview-badge" id="previewBadge"></span>
                <span class="my-note__preview-title" id="previewTitle"></span>
              </div>
              <button class="my-note__preview-close" id="previewClose" title="닫기">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
            <div class="my-note__preview-body" id="previewBody"></div>
          </div>

          <!-- Blank Note (무지) -->
          <div class="my-note__blank is-active" id="blankNote">
            <input
              type="text"
              class="my-note__title-input"
              id="blankTitle"
              placeholder="제목을 입력하세요"
              maxlength="100"
            >
            <div
              class="my-note__content"
              id="blankContent"
              contenteditable="true"
              data-placeholder="자유롭게 생각을 기록하세요..."
            ></div>
          </div>

          <!-- Template Note (양식지) -->
          <div class="my-note__template" id="templateNote">
            <input
              type="text"
              class="my-note__title-input"
              id="templateTitle"
              placeholder="제목을 입력하세요"
              maxlength="100"
            >
            <div class="my-note__template-form" id="templateForm">
              <div class="my-note__question-group">
                <label class="my-note__question-label">
                  <span class="my-note__question-num">Q1</span>
                  오늘 가장 인상 깊었던 것은 무엇인가요?
                </label>
                <textarea class="my-note__question-input" data-question="1" placeholder="답변을 작성하세요..." rows="3"></textarea>
              </div>
              <div class="my-note__question-group">
                <label class="my-note__question-label">
                  <span class="my-note__question-num">Q2</span>
                  그것이 당신에게 어떤 의미를 주었나요?
                </label>
                <textarea class="my-note__question-input" data-question="2" placeholder="답변을 작성하세요..." rows="3"></textarea>
              </div>
              <div class="my-note__question-group">
                <label class="my-note__question-label">
                  <span class="my-note__question-num">Q3</span>
                  떠오르는 감각이나 감정을 자유롭게 표현해보세요.
                </label>
                <textarea class="my-note__question-input" data-question="3" placeholder="답변을 작성하세요..." rows="3"></textarea>
              </div>
              <div class="my-note__question-group">
                <label class="my-note__question-label">
                  <span class="my-note__question-num">Q4</span>
                  이 경험을 통해 새롭게 알게 된 것은?
                </label>
                <textarea class="my-note__question-input" data-question="4" placeholder="답변을 작성하세요..." rows="3"></textarea>
              </div>
              <div class="my-note__question-group">
                <label class="my-note__question-label">
                  <span class="my-note__question-num">Q5</span>
                  내일 해보고 싶은 것이 있다면?
                </label>
                <textarea class="my-note__question-input" data-question="5" placeholder="답변을 작성하세요..." rows="3"></textarea>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- Right 25% - Sidebar -->
      <aside class="my-note__sidebar" id="noteSidebar">

        <!-- Sidebar Tabs -->
        <div class="my-note__sidebar-tabs">
          <button class="my-note__sidebar-tab is-active" data-tab="notes" id="tabNotes">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            <span>내 노트</span>
          </button>
          <button class="my-note__sidebar-tab" data-tab="memos" id="tabMemos">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
            <span>내 메모</span>
          </button>
        </div>

        <!-- Notes List Panel -->
        <div class="my-note__panel is-active" id="panelNotes">
          <div class="my-note__panel-list" id="notesList">
            <!-- JS에서 동적 렌더링 -->
          </div>
          <p class="my-note__panel-empty" id="notesEmpty">
            아직 작성한 노트가 없습니다.<br>
            왼쪽에서 첫 번째 노트를 작성해보세요.
          </p>
        </div>

        <!-- Memos List Panel -->
        <div class="my-note__panel" id="panelMemos">

          <!-- Search Bar -->
          <div class="my-note__memo-search" id="memoSearch">
            <button class="my-note__search-toggle" id="searchToggle" title="검색">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <input type="text" class="my-note__search-input" id="searchInput" placeholder="메모 검색..." />
            <button class="my-note__search-clear" id="searchClear" title="검색 해제">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </div>

          <!-- View Mode Toggle -->
          <div class="my-note__view-modes" id="viewModes">
            <button class="my-note__view-btn is-active" data-view="stream">스트림</button>
            <button class="my-note__view-btn" data-view="timeline">타임라인</button>
            <button class="my-note__view-btn" data-view="source">소스별</button>
          </div>

          <!-- Controls: Source Filter + Sort + Tag Filter -->
          <div class="my-note__memo-controls" id="memoControls">
            <!-- Source Filter -->
            <div class="my-note__control-wrapper" id="sourceFilterWrapper">
              <button class="my-note__control-btn" id="sourceFilterBtn">
                <span id="sourceFilterLabel">전체</span>
                <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
              </button>
              <div class="my-note__control-dropdown" id="sourceFilterDropdown">
                <div class="my-note__control-option is-active" data-source="all">
                  <span>전체</span><span class="my-note__control-option-count" data-count-source="all"></span>
                </div>
                <div class="my-note__control-option" data-source="my-note">
                  <span>My Note</span><span class="my-note__control-option-count" data-count-source="my-note"></span>
                </div>
                <div class="my-note__control-option" data-source="sense-makers">
                  <span>Sense Makers</span><span class="my-note__control-option-count" data-count-source="sense-makers"></span>
                </div>
                <div class="my-note__control-option" data-source="square">
                  <span>Square</span><span class="my-note__control-option-count" data-count-source="square"></span>
                </div>
              </div>
            </div>

            <!-- Sort -->
            <div class="my-note__control-wrapper" id="sortWrapper">
              <button class="my-note__control-btn" id="sortBtn">
                <span id="sortLabel">최신순</span>
                <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
              </button>
              <div class="my-note__control-dropdown" id="sortDropdown">
                <div class="my-note__control-option is-active" data-sort="newest">최신순</div>
                <div class="my-note__control-option" data-sort="oldest">오래된순</div>
                <div class="my-note__control-option" data-sort="updated">최근 수정순</div>
              </div>
            </div>

            <!-- Tag Filter -->
            <div class="my-note__control-wrapper" id="tagFilterWrapper">
              <button class="my-note__control-btn my-note__control-btn--tag" id="tagFilterBtn" title="태그 필터">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
              </button>
              <div class="my-note__control-dropdown my-note__control-dropdown--tags" id="tagFilterDropdown">
                <div class="my-note__control-option is-active" data-tag="all">
                  <span>전체</span>
                </div>
                <div class="my-note__control-option" data-tag="coral">
                  <span class="my-note__tag-dot" style="background:var(--color-tag-coral)"></span><span>Coral</span>
                </div>
                <div class="my-note__control-option" data-tag="blue">
                  <span class="my-note__tag-dot" style="background:var(--color-tag-blue)"></span><span>Blue</span>
                </div>
                <div class="my-note__control-option" data-tag="green">
                  <span class="my-note__tag-dot" style="background:var(--color-tag-green)"></span><span>Green</span>
                </div>
                <div class="my-note__control-option" data-tag="purple">
                  <span class="my-note__tag-dot" style="background:var(--color-tag-purple)"></span><span>Purple</span>
                </div>
                <div class="my-note__control-option" data-tag="orange">
                  <span class="my-note__tag-dot" style="background:var(--color-tag-orange)"></span><span>Orange</span>
                </div>
                <div class="my-note__control-option" data-tag="none">
                  <span>태그 없음</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Pinned Section -->
          <div class="my-note__pinned-section" id="pinnedSection" style="display:none">
            <div class="my-note__pinned-header" id="pinnedHeader">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l1.09 3.26L16 6l-2 2 .71 3.54L12 9.91 9.29 11.54 10 8 8 6l2.91-.74L12 2z"/></svg>
              <span class="my-note__pinned-title">고정됨</span>
              <span class="my-note__pinned-count" id="pinnedCount">0</span>
              <svg class="my-note__pinned-chevron" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="my-note__pinned-list" id="pinnedList"></div>
          </div>

          <!-- Memo List -->
          <div class="my-note__memo-list" id="memosList"></div>
          <button class="my-note__memo-add-btn" id="memoAddBtn" title="새 메모 추가">+</button>
          <p class="my-note__panel-empty" id="memosEmpty" style="display:none">
            아직 작성한 메모가 없습니다.
          </p>
        </div>

      </aside>
    </div>
  </main>

  <!-- Context Menu — Note text -->
  <div class="context-menu" id="contextMenu">
    <div class="context-menu__item" id="contextMemo">
      <span class="context-menu__item-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </span>
      Memo
    </div>
  </div>

  <!-- Context Menu — Memo block (pin / color tag / delete) -->
  <div class="context-menu" id="memoContextMenu">
    <div class="context-menu__item" id="contextPinMemo">
      <span class="context-menu__item-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2l1.09 3.26L16 6l-2 2 .71 3.54L12 9.91 9.29 11.54 10 8 8 6l2.91-.74L12 2z"/>
        </svg>
      </span>
      <span id="contextPinLabel">고정</span>
    </div>
    <div class="context-menu__item context-menu__colors" id="contextColorTag">
      <span class="context-menu__item-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
          <line x1="7" y1="7" x2="7.01" y2="7"/>
        </svg>
      </span>
      <span>태그</span>
      <div class="context-menu__color-dots">
        <span class="color-dot" data-color="coral" title="Coral"></span>
        <span class="color-dot" data-color="blue" title="Blue"></span>
        <span class="color-dot" data-color="green" title="Green"></span>
        <span class="color-dot" data-color="purple" title="Purple"></span>
        <span class="color-dot" data-color="orange" title="Orange"></span>
        <span class="color-dot color-dot--none" data-color="none" title="태그 제거">&times;</span>
      </div>
    </div>
    <div class="context-menu__separator"></div>
    <div class="context-menu__item" id="contextDeleteMemo">
      <span class="context-menu__item-icon">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
      </span>
      삭제
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/common.js"></script>
  <script src="js/my-note.js"></script>
</body>
</html>
